(this["webpackJsonpmovie-rater"]=this["webpackJsonpmovie-rater"]||[]).push([[0],{37:function(e,t,n){},44:function(e,t,n){},48:function(e,t,n){"use strict";n.r(t);var c=n(0),o=n.n(c),i=n(26),r=n.n(i),a=(n(37),n(15)),s=n(3),u=n(10),j=n(9),l=n(27),h=n(28),d=function(){function e(){Object(l.a)(this,e)}return Object(h.a)(e,null,[{key:"updateMovie",value:function(e,t,n){return fetch("".concat("https://movie-rater-khiem.herokuapp.com","/api/movies/").concat(e,"/"),{method:"PUT",headers:{"Content-Type":"application/json",Authorization:"Token ".concat(n)},body:JSON.stringify(t)}).then((function(e){return e.json()}))}},{key:"createMovie",value:function(e,t){return fetch("".concat("https://movie-rater-khiem.herokuapp.com","/api/movies/"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Token ".concat(t)},body:JSON.stringify(e)}).then((function(e){return e.json()}))}},{key:"deleteMovie",value:function(e,t){return fetch("".concat("https://movie-rater-khiem.herokuapp.com","/api/movies/").concat(e,"/"),{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:"Token ".concat(t)}})}},{key:"loginUser",value:function(e){return console.log("https://movie-rater-khiem.herokuapp.com"),fetch("".concat("https://movie-rater-khiem.herokuapp.com","/auth/"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then((function(e){return e.json()}))}},{key:"registerUser",value:function(e){return fetch("".concat("https://movie-rater-khiem.herokuapp.com","/api/users/"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then((function(e){return e.json()}))}},{key:"getMovies",value:function(e){return fetch("".concat("https://movie-rater-khiem.herokuapp.com","/api/movies/"),{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Token ".concat(e)}}).then((function(e){return e.json()}))}}]),e}(),b=n(50),p=n(1);var O=function(e){var t=Object(b.a)(["mr-token"]),n=Object(s.a)(t,2),c=n[0],o=(n[1],function(t){return function(n){e.movieClicked(t)}});return Object(p.jsx)("div",{children:e.movies&&e.movies.map((function(t){return Object(p.jsxs)("div",{className:"movie-item",children:[Object(p.jsx)("h2",{onClick:o(t),children:t.title}),Object(p.jsx)(u.a,{icon:j.a,onClick:function(){return function(t){e.editClicked(t)}(t)}}),Object(p.jsx)(u.a,{icon:j.e,onClick:function(){return function(t){d.deleteMovie(t.id,c["mr-token"]).then((function(){return e.removeClicked(t)})).catch((function(e){return console.log()}))}(t)}})]},t.id)}))})};var f=function(e){var t=Object(c.useState)(-1),n=Object(s.a)(t,2),i=n[0],r=n[1],l=e.movie,h=function(e){return function(t){r(e)}},d=Object(b.a)(["mr-token"]),O=Object(s.a)(d,2),f=O[0],m=(O[1],function(){fetch("http://127.0.0.1:8000/api/movies/".concat(l.id,"/ "),{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Token ".concat(f["mr-token"])}}).then((function(e){return e.json()})).then((function(t){return e.updateMovie(t)})).catch((function(e){return console.log(e)}))});return Object(p.jsx)(o.a.Fragment,{children:l?Object(p.jsxs)("div",{children:[Object(p.jsx)("h1",{children:l.title}),Object(p.jsx)("p",{children:l.description}),Object(a.a)(Array(5)).map((function(e,t){return Object(p.jsx)(u.a,{icon:j.d,className:l.avg_rating>t?"orange":""},t)})),"(",l.no_of_ratings,")",Object(p.jsxs)("div",{className:"rate-container",children:[Object(p.jsx)("h2",{children:"Rate it"}),Object(a.a)(Array(5)).map((function(e,t){return Object(p.jsx)(u.a,{icon:j.d,className:i>t-1?"purple":"",onMouseEnter:h(t),onMouseLeave:h(-1),onClick:(n=t,function(e){fetch("http://127.0.0.1:8000/api/movies/".concat(l.id,"/rate_movie/"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Token ".concat(f["mr-token"])},body:JSON.stringify({stars:n+1})}).then((function(){return m()})).catch((function(e){return console.log(e)}))})},t);var n}))]})]}):null})};var m=function(e){var t=Object(c.useState)(""),n=Object(s.a)(t,2),i=n[0],r=n[1],a=Object(c.useState)(""),u=Object(s.a)(a,2),j=u[0],l=u[1],h=Object(b.a)(["mr-token"]),O=Object(s.a)(h,2),f=O[0];O[1],Object(c.useEffect)((function(){r(e.movie.title),l(e.movie.description)}),[e.movie]);var m=0===i.length||0===j.length;return Object(p.jsx)(o.a.Fragment,{children:e.movie?Object(p.jsxs)("div",{children:[Object(p.jsx)("label",{for:"title",children:" Title "}),Object(p.jsx)("br",{}),Object(p.jsx)("input",{id:"title",type:"text",placeholder:"title",value:i,onChange:function(e){return r(e.target.value)}}),Object(p.jsx)("br",{}),Object(p.jsx)("label",{for:"description",children:"Description"}),Object(p.jsx)("br",{}),Object(p.jsx)("textarea",{id:"description",type:"text",placeholder:"Description",value:j,onChange:function(e){return l(e.target.value)}}),Object(p.jsx)("br",{}),e.movie.id?Object(p.jsx)("button",{onClick:function(){console.log("update here"),d.updateMovie(e.movie.id,{title:i,description:j},f["mr-token"]).then((function(t){return e.updatedMovie(t)})).catch((function(e){return console.log(e)}))},disabled:m,children:"Update"}):Object(p.jsx)("button",{onClick:function(){console.log("create here"),d.createMovie({title:i,description:j},f["mr-token"]).then((function(t){return e.movieCreated(t)})).catch((function(e){return console.log(e)}))},disabled:m,children:"Create"})]}):null})},v=(n(44),n(23)),x=n.n(v),k=n(29);var g=function(){var e=Object(c.useState)([]),t=Object(s.a)(e,2),n=t[0],o=t[1],i=Object(c.useState)(!0),r=Object(s.a)(i,2),a=r[0],u=r[1],j=Object(c.useState)(),l=Object(s.a)(j,2),h=l[0],p=l[1],O=Object(b.a)(["mr-token"]),f=Object(s.a)(O,1)[0];return Object(c.useEffect)((function(){function e(){return e=Object(k.a)(x.a.mark((function e(){var t;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u(!0),p(),e.next=4,d.getMovies(f["mr-token"]).catch((function(e){return p(e)}));case 4:t=e.sent,o(t),u(!1);case 7:case"end":return e.stop()}}),e)}))),e.apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[]),[n,a,h]};var y=function(){var e=Object(c.useState)([]),t=Object(s.a)(e,2),n=t[0],o=t[1],i=Object(c.useState)(null),r=Object(s.a)(i,2),l=r[0],h=r[1],d=Object(c.useState)(null),v=Object(s.a)(d,2),x=v[0],k=v[1],y=Object(b.a)(["mr-token"]),C=Object(s.a)(y,3),T=C[0],S=(C[1],C[2]),w=g(),N=Object(s.a)(w,3),M=N[0],E=N[1],A=N[2];Object(c.useEffect)((function(){console.log(M),o(M)}),[M]),Object(c.useEffect)((function(){console.log(T),T["mr-token"]||(window.location.href="/")}),[T]);var L=function(e){h(e),k(null)};return E?Object(p.jsx)("h1",{children:"Loading..."}):A?Object(p.jsx)("h1",{children:"Error loading movies"}):Object(p.jsxs)("div",{className:"App",children:[Object(p.jsxs)("header",{className:"App-header",children:[Object(p.jsxs)("h1",{children:[Object(p.jsx)(u.a,{icon:j.b}),Object(p.jsx)("span",{children:" Movie rater"})]}),Object(p.jsx)(u.a,{icon:j.c,onClick:function(){S(["mr-token"])}})]}),Object(p.jsxs)("div",{className:"layout",children:[Object(p.jsxs)("div",{children:[Object(p.jsx)(O,{movies:n,movieClicked:L,editClicked:function(e){k(e),h(null)},removeClicked:function(e){var t=n.filter((function(t){return t.id!==e.id}));o(t)}}),Object(p.jsx)("button",{onClick:function(){k({title:"",description:""}),h(null)},children:"New movie"})]}),Object(p.jsx)(f,{movie:l,updateMovie:L}),x?Object(p.jsx)(m,{movie:x,updatedMovie:function(e){var t=n.map((function(t){return t.id===e.id?e:t}));o(t)},movieCreated:function(e){var t=[].concat(Object(a.a)(n),[e]);o(t)}}):null]})]})},C=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,51)).then((function(t){var n=t.getCLS,c=t.getFID,o=t.getFCP,i=t.getLCP,r=t.getTTFB;n(e),c(e),o(e),i(e),r(e)}))},T=n(30),S=n(4);var w=function(){var e=Object(c.useState)(""),t=Object(s.a)(e,2),n=t[0],o=t[1],i=Object(c.useState)(""),r=Object(s.a)(i,2),a=r[0],u=r[1],j=Object(b.a)(["mr-token"]),l=Object(s.a)(j,2),h=l[0],O=l[1],f=Object(c.useState)(!0),m=Object(s.a)(f,2),v=m[0],x=m[1],k=Object(c.useState)(!1),g=Object(s.a)(k,2),y=g[0],C=g[1],T=function(){d.loginUser({username:n,password:a}).then((function(e){return O("mr-token",e.token)})).catch((function(e){return console.log(e)}))},S=0===n.length||0===a.length;return Object(c.useEffect)((function(){h["mr-token"]&&"undefined"!==h["mr-token"]?(window.location.href="/movies",C(!1)):h["mr-token"]&&"undefined"===h["mr-token"]&&C(!0)}),[h]),Object(p.jsxs)("div",{className:"App",children:[Object(p.jsx)("header",{className:"App-header",children:Object(p.jsx)("h1",{children:v?Object(p.jsx)("h1",{children:"Login"}):Object(p.jsx)("h1",{children:"Register"})})}),Object(p.jsxs)("div",{className:"login-container",children:[console.log("ads",n),Object(p.jsx)("label",{htmlFor:"username",children:" username "}),Object(p.jsx)("br",{}),Object(p.jsx)("input",{id:"username",type:"text",placeholder:"username",value:n,onChange:function(e){return o(e.target.value)}}),Object(p.jsx)("br",{}),Object(p.jsx)("label",{for:"password",children:"password"}),Object(p.jsx)("br",{}),Object(p.jsx)("input",{id:"password",type:"password",placeholder:"password",value:a,onChange:function(e){return u(e.target.value)}}),Object(p.jsx)("br",{}),v?Object(p.jsx)("button",{onClick:T,disabled:S,children:"Login"}):Object(p.jsx)("button",{onClick:function(){d.registerUser({username:n,password:a}).then((function(e){return T()})).catch((function(e){return console.log(e)}))},disabled:S,children:"Register"}),v&&y?Object(p.jsx)("p",{className:"warning",children:"Your username/password is wrong. Please try again!"}):Object(p.jsx)("p",{}),v?Object(p.jsx)("p",{onClick:function(){return x(!1)},children:"You do not have an account? Register here!"}):Object(p.jsx)("p",{onClick:function(){return x(!0)},children:"You already have an account? Login here"})]})]})},N=n(49);function M(){return Object(p.jsx)(o.a.StrictMode,{children:Object(p.jsx)(N.a,{children:Object(p.jsxs)(T.a,{children:[Object(p.jsx)(S.a,{exact:!0,path:"/",component:w}),Object(p.jsx)(S.a,{exact:!0,path:"/movies",component:y})]})})})}r.a.render(Object(p.jsx)(M,{}),document.getElementById("root")),C()}},[[48,1,2]]]);
//# sourceMappingURL=main.14fbb629.chunk.js.map